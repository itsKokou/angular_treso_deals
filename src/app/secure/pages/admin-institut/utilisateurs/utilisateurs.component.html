 <div class="w-full px-6 py-6 mx-auto">
    <div class="mt-4 flex justify-end">
    <a id="btnAddProfil" data-modal-target="profil-modal" data-modal-toggle="profil-modal" class="px-6 py-2 flex bg-blue-700 text-white font-medium rounded-md hover:bg-blue-800">
      <svg class="w-4 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
      </svg>
      <span>Nouveau</span>
    </a>
  </div>

  <div class="flex flex-wrap mt-6">
    <div class="relative w-full flex flex-col mb-6 bg-white shadow-soft-xl rounded-lg">
      <div class="py-4 px-4 pb-0 mb-0 bg-white border-b-0 border-b-solid rounded-t-2xl border-b-transparent">
        <h6 class="font-bold text-lg text-gray-800">Liste d'utilisateurs</h6>
      </div>
      <div class="p-0 overflow-x-auto">
        <table  class="w-full border-gray-200 text-slate-700">
          <thead class="align-bottom">
            <tr>
              <th class="px-4 py-3 font-bold text-left uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Id</th>
              <th class="px-4 py-3 font-bold text-left uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Nom</th>
              <th class="px-4 py-3 font-bold text-left uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Prénom</th>
              <th class="px-4 py-3 font-bold text-left uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Email</th>
              <th class="px-4 py-3 font-bold text-left uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Date d’adhesion</th>
              <th class="px-4 py-3 font-bold text-center uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Profil</th>
              <th class="px-4 py-3 font-bold text-center uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Institution</th>
              <th class="px-4 py-3 font-bold text-center uppercase border-b border-gray-200 text-xs whitespace-nowrap text-slate-400">Contact</th>
            </tr>
          </thead>
          <tbody>
          @for (item of datasPaginated; track $index) {
            <tr>
              <td class="px-4 border-b text-left">
                <p class="text-sm leading-normal py-2">{{item.id}}</p>
              </td>
              <td class="px-4 border-b text-left">
                <p class="text-sm leading-normal">{{item.lastName}}</p>
              </td>
              <td class="px-4 border-b text-left">
                <p class="text-sm leading-normal">{{item.firstName }}</p>
              </td>
              <td class="px-4 border-b text-left">
                <p class="text-sm leading-normal">{{item.email }}</p>
              </td>
              <td class="px-4 border-b text-left">
                <p class="text-sm leading-normal">March 25, 2021</p>
              </td>
              <td class="px-4 border-b text-center">
                <p class="text-sm leading-normal">{{item.profile}}</p>
              </td>
              <td class="px-4 border-b text-center">
                <p class="text-sm leading-normal">{{item.institutionName}}</p>
              </td>
              <td class="px-4 border-b text-center">
                <p class="text-sm leading-normal">{{item.phoneNumber}}</p>
              </td>
            </tr>
          }  
          </tbody>
        </table>
      </div>
      <div *ngIf="isLoading">
          <mat-progress-bar class="text-purple-800" mode="indeterminate"></mat-progress-bar>
      </div>
      <div>
        <mat-paginator showFirstLastButtons
              [length] ="totalElements"
              [pageSize]="5"
              [pageSizeOptions]="[5, 10, 25]"
              aria-label="Select page"
              (page)="onPageChange($event)">
        </mat-paginator>
      </div>
    </div>
  </div>
</div>

<div id="profil-modal" (submit)="onSubmit()" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-full max-w-5xl max-h-full">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <!-- Modal header -->
      <div class="flex align-middle bg-blue-800 items-center justify-between px-4 py-2 border-b rounded-t-lg ">
        <h3 class="text-xl mb-0 font-medium text-white ">
          Nouvel Utilisateur
        </h3>
        <button type="button" id="closeProfilModal" class="text-white bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center" data-modal-hide="profil-modal">
          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
          </svg>
        </button>
      </div>
      <!-- Modal body -->
      <form [formGroup] = "formProfil" class="pt-6" action="" method="post">
        <div class="flex justify-between items-start">
          <div class="w-full">
            <div class="mb-4 px-8">
              <input formControlName="lastName" type="text" name="n_transaction" id="n_transaction" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Nom :" required>
              @if(lastName.errors && (lastName.dirty || lastName.touched)){
                  @if(lastName.getError("required")){
                      <p class="text-left text-sm " style="color: red;">Le nom est obligatoire</p>
                  }
                  @if(lastName.getError("minlength")){
                      <p class="text-left text-sm " style="color: red;">Minimum 2 caractères</p>
                  }
              }
            </div>

            <div class="mb-4 px-8">
              <input formControlName="firstName" type="text" name="first_name" id="first_name" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Prénom :" required>
              @if(firstName.errors && (firstName.dirty || firstName.touched)){
                  @if(firstName.getError("required")){
                      <p class="text-left text-sm " style="color: red;">Le prénom est obligatoire</p>
                  }
                  @if(firstName.getError("minlength")){
                      <p class="text-left text-sm " style="color: red;">Minimum 2 caractères</p>
                  }
              }
            </div>

            <div class="mb-4 px-8">
              <input formControlName="email" type="email" name="email_" id="email_" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Email :" required>
              @if(email.errors && (email.dirty || email.touched)){
                  @if(email.getError("required")){
                      <p class="text-left text-sm " style="color: red;">L'e-mail portable est obligatoire</p>
                  }
                  @if(email.getError("email")){
                      <p class="text-left text-sm " style="color: red;">L'e-mail n'est pas valide</p>
                  }
              }
            </div>

            <div class="mb-4 px-8">
              <input formControlName="secondEmail" type="email" name="second_mail" id="second_mail" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Email secondaire :">
            </div>
            
            <div class="mb-4 px-8">
              <select formControlName="profile" id="type_profil" name="type_profil" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3">
                <option disabled [selected]="1">Sélectionnez le type de profil</option>
                <option value="TRADER">Trader</option>
                <option value="BANK_VALIDATOR">Validateur</option>
                <option value="BANK_OPERATOR">Opérateur</option>
              </select>  
              @if(profile.errors && (profile.dirty || profile.touched)){
                @if(profile.getError("required")){
                    <p class="text-left text-sm " style="color: red;">Le type de profil est obligatoire</p>
                }
              }                           
            </div>
          </div>

          <div class="w-full">
            <div class="mb-4 px-8">
              <input formControlName="phoneNumber" type="text" name="phone" id="phone" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Téléphone portable (+Indicatif) :" required>
              @if(phoneNumber.errors && (phoneNumber.dirty || phoneNumber.touched)){
                @if(phoneNumber.getError("required")){
                    <p class="text-left text-sm " style="color: red;">Le téléphone portable est obligatoire</p>
                }
              }
            </div>
            
            <div class="mb-4 px-8">
              <input formControlName="fixeNumber" type="text" name="fixe" id="fixe" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Téléphone fixe . (+Indicatif) :" required>
              @if(fixeNumber.errors && (fixeNumber.dirty || fixeNumber.touched)){
                  @if(fixeNumber.getError("required")){
                      <p class="text-left text-sm " style="color: red;">Le téléphone fixe est obligatoire</p>
                  }
              }
            </div>
            
            <div class="mb-4 px-8">
              <input formControlName="job" type="text" name="job_" id="job_" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Fonction occupée :" required>
              @if(job.errors && (job.dirty || job.touched)){
                @if(job.getError("required")){
                    <p class="text-left text-sm " style="color: red;">La fonction est obligatoire</p>
                }
                @if(job.getError("minlength")){
                    <p class="text-left text-sm " style="color: red;">Minimum 2 caractères</p>
                }
              }
            </div>
            
            <div class="mb-4 px-8">
              <input formControlName="department" type="text" name="department_" id="department_" class="w-full border bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-400 placeholder:font-medium text-base rounded-md focus:ring-blue-500 focus:border-blue-500 block py-1.5 px-3" placeholder="Direction/Département :" required>
              @if(department.errors && (department.dirty || department.touched)){
                @if(department.getError("required")){
                    <p class="text-left text-sm " style="color: red;">Le département est obligatoire</p>
                }
                @if(department.getError("minlength")){
                    <p class="text-left text-sm " style="color: red;">Minimum 2 caractères</p>
                }
              }
            </div>
          </div>
        </div>
        
        

        <!-- Modal footer -->
        <div class="flex items-center justify-end py-3 px-8 border-t border-gray-200 rounded-b">
          <button data-modal-hide="profil-modal" (click)="resetFormProfil()" type="button" class="text-white font-medium !bg-gray-400 hover:!bg-gray-700 text-sm px-5 py-1.5 text-center rounded focus:ring-0 focus:outline-none">Annuler</button>
          <button type="submit" class="ml-5 text-white font-medium !bg-green-500 hover:!bg-green-600 text-sm px-5 py-1.5 text-center rounded focus:ring-0 focus:outline-none">Créer</button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- SPINNER  -->
<button id="openSpinner" data-modal-target="spinner-modal" data-modal-toggle="spinner-modal" class="hidden" type="button">
  Toggle Spinner
</button>

<button  id="closeSpinner" data-modal-hide="spinner-modal" type="button" class="hidden">
  Fermer
</button>

<div id="spinner-modal" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-full max-w-2xl max-h-full">
    <div class="relative bg-transparent">
      <div class="flex justify-center items-center p-4">
        <mat-spinner></mat-spinner>
      </div>
    </div>
  </div>
</div>


<!-- CONFIRMATION PROFIL -->
<button id="btnConfirmProfil" data-modal-target="confirm-profil-modal" data-modal-toggle="confirm-profil-modal"  type="button" class="ml-4 hidden text-white !bg-green-500 hover:!bg-green-600 font-medium rounded-lg text-sm px-5 py-2 text-center">
  confirmer
</button>
<!--Modal de confirm--> 
<div id="confirm-profil-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-full max-w-2xl max-h-full">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <!-- Modal header -->
      <div class="flex align-middle bg-blue-800 items-center justify-between px-4 py-2 border-b rounded-t-lg ">
        <h3 class="text-xl mb-0 font-medium text-white ">
          Demande de confirmation
        </h3>
        <button type="button" class="text-white bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center" data-modal-hide="confirm-profil-modal">
          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
          </svg>
        </button>
      </div>
      <!-- Modal body -->
      <div class="text-center px-8 py-5 space-y-4">
        <svg class="text-green-500 w-16" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
       <p class="mb-5 text-lg font-normal text-gray-700 dark:text-gray-400">Voulez-vous confirmer la création du profil de l'utilisateur {{firstName.value + " " + lastName.value}} ?</p>
      </div>
      <!-- Modal footer -->
      <div class="flex items-center justify-end py-3 px-8 border-t border-gray-200 rounded-b">
        <button data-modal-hide="confirm-profil-modal" (click)="resetFormProfil()" type="button" class="text-white font-medium !bg-gray-400 hover:!bg-gray-700 text-sm px-5 py-1.5 text-center rounded focus:ring-0 focus:outline-none">Annuler</button>
        <button data-modal-hide="confirm-profil-modal" (click)="confirmProfilSubmission()" type="button" class="ml-5 !bg-green-500 hover:!bg-green-700 text-white font-medium text-sm px-5 py-1.5 text-center rounded focus:ring-0 focus:outline-none">Confirmer</button>
      </div>
    </div>
  </div>
</div>
